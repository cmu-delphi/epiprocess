<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Detect outliers — detect_outlr • epiprocess</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.9/font.css" rel="stylesheet"><link href="../deps/Source_Serif_Pro-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Detect outliers — detect_outlr"><meta name="description" content="Applies one or more outlier detection methods to a given signal variable, and
optionally aggregates the outputs to create a consensus result. See the
outliers vignette for
examples.
detect_outlr_rm detects outliers based on a distance from the
rolling median specified in terms of multiples of the rolling interquartile
range (IQR).
detect_outlr_stl detects outliers based on a seasonal-trend
decomposition using LOESS (STL)."><meta property="og:description" content="Applies one or more outlier detection methods to a given signal variable, and
optionally aggregates the outputs to create a consensus result. See the
outliers vignette for
examples.
detect_outlr_rm detects outliers based on a distance from the
rolling median specified in terms of multiples of the rolling interquartile
range (IQR).
detect_outlr_stl detects outliers based on a seasonal-trend
decomposition using LOESS (STL)."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epiprocess</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.11.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/epiprocess.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/epi_df.html">Working with epi_df objects and time series data</a></li>
    <li><a class="dropdown-item" href="../articles/epi_archive.html">Working with epi_archive objects and data revisions</a></li>
    <li><a class="dropdown-item" href="../articles/outliers.html">Detect and correct outliers in signals</a></li>
    <li><a class="dropdown-item" href="../articles/growth_rate.html">Estimate growth rates in signals</a></li>
    <li><a class="dropdown-item" href="../articles/correlation.html">Correlate signals across locations and time</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cmu-delphi/epiprocess/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Detect outliers</h1>
      <small class="dont-index">Source: <a href="https://github.com/cmu-delphi/epiprocess/blob/dev/R/outliers.R" class="external-link"><code>R/outliers.R</code></a></small>
      <div class="d-none name"><code>detect_outlr.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Applies one or more outlier detection methods to a given signal variable, and
optionally aggregates the outputs to create a consensus result. See the
<a href="https://cmu-delphi.github.io/epiprocess/articles/outliers.html">outliers vignette</a> for
examples.</p>
<p><code>detect_outlr_rm</code> detects outliers based on a distance from the
rolling median specified in terms of multiples of the rolling interquartile
range (IQR).</p>
<p><code>detect_outlr_stl</code> detects outliers based on a seasonal-trend
decomposition using LOESS (STL).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">detect_outlr</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  methods <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"rm"</span>, args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, abbr <span class="op">=</span> <span class="st">"rm"</span><span class="op">)</span>,</span>
<span>  combiner <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"median"</span>, <span class="st">"mean"</span>, <span class="st">"none"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">detect_outlr_rm</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  log_transform <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  detect_negatives <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  detection_multiplier <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  min_radius <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  replacement_multiplier <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">detect_outlr_stl</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>  <span class="va">y</span>,</span>
<span>  n_trend <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  n_seasonal <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  n_threshold <span class="op">=</span> <span class="fl">21</span>,</span>
<span>  <span class="va">seasonal_period</span>,</span>
<span>  seasonal_as_residual <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  log_transform <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  detect_negatives <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  detection_multiplier <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  min_radius <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  replacement_multiplier <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Design points corresponding to the signal values <code>y</code>. Default is
<code>seq_along(y)</code> (that is, equally-spaced points from 1 to the length of
<code>y</code>).</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Signal values.</p></dd>


<dt id="arg-methods">methods<a class="anchor" aria-label="anchor" href="#arg-methods"></a></dt>
<dd><p>A tibble specifying the method(s) to use for outlier
detection, with one row per method, and the following columns:</p><ul><li><p><code>method</code>: Either "rm" or "stl", or a custom function for outlier
detection; see details for further explanation.</p></li>
<li><p><code>args</code>: Named list of arguments that will be passed to the detection
method.</p></li>
<li><p><code>abbr</code>: Abbreviation to use in naming output columns with results from
this method.</p></li>
</ul></dd>


<dt id="arg-combiner">combiner<a class="anchor" aria-label="anchor" href="#arg-combiner"></a></dt>
<dd><p>String, one of "median", "mean", or "none", specifying how to
combine results from different outlier detection methods for the thresholds
determining whether a particular observation is classified as an outlier,
as well as a replacement value for any outliers.  If "none", then no
summarized results are calculated. Note that if the number of <code>methods</code>
(number of rows) is odd, then "median" is equivalent to a majority vote for
purposes of determining whether a given observation is an outlier.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Number of time steps to use in the rolling window. Default is 21.
This value is centrally aligned. When <code>n</code> is an odd number, the rolling
window extends from <code>(n-1)/2</code> time steps before each design point to <code>(n-1)/2</code>
time steps after. When <code>n</code> is even, then the rolling range extends from
<code>n/2-1</code> time steps before to <code>n/2</code> time steps after.</p></dd>


<dt id="arg-log-transform">log_transform<a class="anchor" aria-label="anchor" href="#arg-log-transform"></a></dt>
<dd><p>Should a log transform be applied before running outlier
detection? Default is <code>FALSE</code>. If <code>TRUE</code>, and zeros are present, then the
log transform will be padded by 1.</p></dd>


<dt id="arg-detect-negatives">detect_negatives<a class="anchor" aria-label="anchor" href="#arg-detect-negatives"></a></dt>
<dd><p>Should negative values automatically count as
outliers? Default is <code>FALSE</code>.</p></dd>


<dt id="arg-detection-multiplier">detection_multiplier<a class="anchor" aria-label="anchor" href="#arg-detection-multiplier"></a></dt>
<dd><p>Value determining how far the outlier detection
thresholds are from the rolling median, which are calculated as (rolling
median) +/- (detection multiplier) * (rolling IQR). Default is 2.</p></dd>


<dt id="arg-min-radius">min_radius<a class="anchor" aria-label="anchor" href="#arg-min-radius"></a></dt>
<dd><p>Minimum distance between rolling median and threshold, on
transformed scale. Default is 0.</p></dd>


<dt id="arg-replacement-multiplier">replacement_multiplier<a class="anchor" aria-label="anchor" href="#arg-replacement-multiplier"></a></dt>
<dd><p>Value determining how far the replacement
values are from the rolling median. The replacement is the original value
if it is within the detection thresholds, or otherwise it is rounded to the
nearest (rolling median) +/- (replacement multiplier) * (rolling IQR).
Default is 0.</p></dd>


<dt id="arg-n-trend">n_trend<a class="anchor" aria-label="anchor" href="#arg-n-trend"></a></dt>
<dd><p>Number of time steps to use in the rolling window for trend.
Default is 21.</p></dd>


<dt id="arg-n-seasonal">n_seasonal<a class="anchor" aria-label="anchor" href="#arg-n-seasonal"></a></dt>
<dd><p>Number of time steps to use in the rolling window for
seasonality. Default is 21. Can also be the string "periodic". See
<code>s.window</code> in <code><a href="https://rdrr.io/r/stats/stl.html" class="external-link">stats::stl</a></code>.</p></dd>


<dt id="arg-n-threshold">n_threshold<a class="anchor" aria-label="anchor" href="#arg-n-threshold"></a></dt>
<dd><p>Number of time steps to use in rolling window for the IQR
outlier thresholds.</p></dd>


<dt id="arg-seasonal-period">seasonal_period<a class="anchor" aria-label="anchor" href="#arg-seasonal-period"></a></dt>
<dd><p>Integer specifying period of "seasonality". For
example, for daily data, a period 7 means weekly seasonality. It must be
strictly larger than 1. Also impacts the size of the low-pass filter
window; see <code>l.window</code> in <code><a href="https://rdrr.io/r/stats/stl.html" class="external-link">stats::stl</a></code>.</p></dd>


<dt id="arg-seasonal-as-residual">seasonal_as_residual<a class="anchor" aria-label="anchor" href="#arg-seasonal-as-residual"></a></dt>
<dd><p>Boolean specifying whether the seasonal(/weekly)
component should be treated as part of the residual component instead of as
part of the predictions. The default, FALSE, treats them as part of the
predictions, so large seasonal(/weekly) components will not lead to
flagging points as outliers. <code>TRUE</code> may instead consider the extrema of
large seasonal variations to be outliers; <code>n_seasonal</code> and
<code>seasonal_period</code> will still have an impact on the result, though, by
impacting the estimation of the trend component.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An tibble with number of rows equal to <code>length(y)</code> and columns
giving the outlier detection thresholds (<code>lower</code> and <code>upper</code>) and
replacement values from each detection method (<code>replacement</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Each outlier detection method, one per row of the passed <code>methods</code>
tibble, is a function that must take as its first two arguments <code>x</code> and
<code>y</code>, and then any number of additional arguments. The function must return
a tibble with the number of rows equal to <code>length(y)</code>, and with columns
<code>lower</code>, <code>upper</code>, and <code>replacement</code>, representing lower and upper bounds
for what would be considered an outlier, and a posited replacement value,
respectively.</p>
<p>For convenience, the outlier detection method can be specified (in the
<code>method</code> column of <code>methods</code>) by a string "rm", shorthand for
<code>detect_outlr_rm()</code>, which detects outliers via a rolling median; or by
"stl", shorthand for <code>detect_outlr_stl()</code>, which detects outliers via an
STL decomposition.</p>
<p>The STL decomposition is computed using <code><a href="https://rdrr.io/r/stats/stl.html" class="external-link">stats::stl()</a></code>. Once
computed, the outlier detection method is analogous to the rolling median
method in <code>detect_outlr_rm()</code>, except with the fitted values and residuals
from the STL decomposition taking the place of the rolling median and
residuals to the rolling median, respectively.</p>
<p>The last set of arguments, <code>log_transform</code> through <code>replacement_multiplier</code>,
are exactly as in <code>detect_outlr_rm()</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">detection_methods</span> <span class="op">&lt;-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"rm"</span>,</span></span>
<span class="r-in"><span>    args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      detect_negatives <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>      detection_multiplier <span class="op">=</span> <span class="fl">2.5</span></span></span>
<span class="r-in"><span>    <span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    abbr <span class="op">=</span> <span class="st">"rm"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"stl"</span>,</span></span>
<span class="r-in"><span>    args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      detect_negatives <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>      detection_multiplier <span class="op">=</span> <span class="fl">2.5</span>,</span></span>
<span class="r-in"><span>      seasonal_period <span class="op">=</span> <span class="fl">7</span></span></span>
<span class="r-in"><span>    <span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    abbr <span class="op">=</span> <span class="st">"stl_seasonal"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"stl"</span>,</span></span>
<span class="r-in"><span>    args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      detect_negatives <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>      detection_multiplier <span class="op">=</span> <span class="fl">2.5</span>,</span></span>
<span class="r-in"><span>      seasonal_period <span class="op">=</span> <span class="fl">7</span>,</span></span>
<span class="r-in"><span>      seasonal_as_residual <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span>    <span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    abbr <span class="op">=</span> <span class="st">"stl_reseasonal"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">covid_incidence_outliers</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">geo_value</span>, <span class="va">time_value</span>, <span class="va">cases</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="epi_df.html">as_epi_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">geo_value</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>outlier_info <span class="op">=</span> <span class="fu">detect_outlr</span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">time_value</span>, y <span class="op">=</span> <span class="va">cases</span>,</span></span>
<span class="r-in"><span>    methods <span class="op">=</span> <span class="va">detection_methods</span>,</span></span>
<span class="r-in"><span>    combiner <span class="op">=</span> <span class="st">"median"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html" class="external-link">unnest</a></span><span class="op">(</span><span class="va">outlier_info</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Detect outliers based on a rolling median</span></span></span>
<span class="r-in"><span><span class="va">covid_incidence_outliers</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">geo_value</span>, <span class="va">time_value</span>, <span class="va">cases</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="epi_df.html">as_epi_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">geo_value</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>outlier_info <span class="op">=</span> <span class="fu">detect_outlr_rm</span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">time_value</span>, y <span class="op">=</span> <span class="va">cases</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An `epi_df` object, 730 x 4 with metadata:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * geo_type  = state</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * time_type = day</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * as_of     = 2021-10-28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 730 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   geo_value [2]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    geo_value time_value cases outlier_info$lower $upper $replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> fl        2020-06-01   667               530   <span style="text-decoration: underline;">2</span>010           667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> nj        2020-06-01   486               150.   840.          486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> fl        2020-06-02   617               582.  <span style="text-decoration: underline;">1</span>992.          617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> nj        2020-06-02   658               210.   771.          658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> fl        2020-06-03  <span style="text-decoration: underline;">1</span>317               635   <span style="text-decoration: underline;">1</span>975          <span style="text-decoration: underline;">1</span>317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> nj        2020-06-03   541               270    702           541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> fl        2020-06-04  <span style="text-decoration: underline;">1</span>419               713   <span style="text-decoration: underline;">1</span>909          <span style="text-decoration: underline;">1</span>419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> nj        2020-06-04   478               174.   790.          478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> fl        2020-06-05  <span style="text-decoration: underline;">1</span>305               553   <span style="text-decoration: underline;">2</span>081          <span style="text-decoration: underline;">1</span>305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> nj        2020-06-05   825               118.   838.          825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 720 more rows</span></span>
<span class="r-in"><span><span class="co"># Detects outliers based on a seasonal-trend decomposition using LOESS</span></span></span>
<span class="r-in"><span><span class="va">covid_incidence_outliers</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">geo_value</span>, <span class="va">time_value</span>, <span class="va">cases</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="epi_df.html">as_epi_df</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">geo_value</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>outlier_info <span class="op">=</span> <span class="fu">detect_outlr_stl</span><span class="op">(</span></span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="va">time_value</span>, y <span class="op">=</span> <span class="va">cases</span>,</span></span>
<span class="r-in"><span>    seasonal_period <span class="op">=</span> <span class="fl">7</span> <span class="co"># weekly seasonality for daily data</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An `epi_df` object, 730 x 4 with metadata:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * geo_type  = state</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * time_type = day</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * as_of     = 2021-10-28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 730 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># Groups:   geo_value [2]</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    geo_value time_value cases outlier_info$lower $upper $replacement</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> fl        2020-06-01   667             -<span style="color: #BB0000; text-decoration: underline;">1</span><span style="color: #BB0000;">193.</span>  <span style="text-decoration: underline;">1</span>233.          667</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> nj        2020-06-01   486               281.   762.          486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> fl        2020-06-02   617              -<span style="color: #BB0000;">691.</span>  <span style="text-decoration: underline;">1</span>890.          617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> nj        2020-06-02   658               317.   891.          658</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> fl        2020-06-03  <span style="text-decoration: underline;">1</span>317              -<span style="color: #BB0000;">144.</span>  <span style="text-decoration: underline;">2</span>396.         <span style="text-decoration: underline;">1</span>317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> nj        2020-06-03   541               292.   809.          541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> fl        2020-06-04  <span style="text-decoration: underline;">1</span>419               260.  <span style="text-decoration: underline;">2</span>696.         <span style="text-decoration: underline;">1</span>419</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> nj        2020-06-04   478               315.   792.          478</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> fl        2020-06-05  <span style="text-decoration: underline;">1</span>305               548.  <span style="text-decoration: underline;">2</span>950.         <span style="text-decoration: underline;">1</span>305</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> nj        2020-06-05   825               382.   835.          825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 720 more rows</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p><a href="https://delphi.cmu.edu/about/" class="external-link">About Delphi</a> • <a href="https://delphi.cmu.edu/epidemic-signals/terms-of-use/" class="external-link">Terms of Use</a> • <a href="https://docs.google.com/forms/u/1/d/e/1FAIpQLScqgT1fKZr5VWBfsaSp-DNaN03aV6EoZU4YljIzHJ1Wl_zmtg/viewform" class="external-link">Contact Us</a> • <a href="https://github.com/cmu-delphi/" class="external-link">Delphi GitHub</a> • <a href="https://cmu-delphi.github.io/delphi-epidata/" class="external-link">Epidata API</a></p>
</div>

<div class="pkgdown-footer-right">
  <p>epiprocess</p>
</div>

    </footer></div>





  </body></html>

