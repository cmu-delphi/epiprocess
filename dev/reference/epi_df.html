<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>epi_df object — epi_df • epiprocess</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="epi_df object — epi_df"><meta name="description" content="An epi_df is a tibble with certain minimal column structure and metadata.
It can be seen as a snapshot of a data set that contains the most
up-to-date values of some signal variables of interest, as of a given time."><meta property="og:description" content="An epi_df is a tibble with certain minimal column structure and metadata.
It can be seen as a snapshot of a data set that contains the most
up-to-date values of some signal variables of interest, as of a given time."><meta name="robots" content="noindex"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epiprocess</a>

    <small class="nav-text text-success me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">0.8.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/epiprocess.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/slide.html">Slide a computation over signal values</a></li>
    <li><a class="dropdown-item" href="../articles/growth_rate.html">Estimate growth rates in signals</a></li>
    <li><a class="dropdown-item" href="../articles/correlation.html">Correlate signals over space and time</a></li>
    <li><a class="dropdown-item" href="../articles/aggregation.html">Aggregate signals over space and time</a></li>
    <li><a class="dropdown-item" href="../articles/outliers.html">Detect and correct outliers in signals</a></li>
    <li><a class="dropdown-item" href="../articles/archive.html">Work with archive objects and data revisions</a></li>
    <li><a class="dropdown-item" href="../articles/advanced.html">Advanced sliding with nonstandard outputs</a></li>
    <li><a class="dropdown-item" href="../articles/compactify.html">Compactify to remove redundant archive data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/cmu-delphi/epiprocess/tree/main/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1><code>epi_df</code> object</h1>
      <small class="dont-index">Source: <a href="https://github.com/cmu-delphi/epiprocess/blob/main/R/epi_df.R" class="external-link"><code>R/epi_df.R</code></a></small>
      <div class="d-none name"><code>epi_df.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>An <code>epi_df</code> is a tibble with certain minimal column structure and metadata.
It can be seen as a snapshot of a data set that contains the most
up-to-date values of some signal variables of interest, as of a given time.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">new_epi_df</span><span class="op">(</span></span>
<span>  x <span class="op">=</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">geo_type</span>,</span>
<span>  <span class="va">time_type</span>,</span>
<span>  <span class="va">as_of</span>,</span>
<span>  additional_metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">as_epi_df</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'epi_df'</span></span>
<span><span class="fu">as_epi_df</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'tbl_df'</span></span>
<span><span class="fu">as_epi_df</span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  geo_type <span class="op">=</span> <span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  time_type <span class="op">=</span> <span class="fu">deprecated</span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">as_of</span>,</span>
<span>  additional_metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'data.frame'</span></span>
<span><span class="fu">as_epi_df</span><span class="op">(</span><span class="va">x</span>, <span class="va">as_of</span>, additional_metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'tbl_ts'</span></span>
<span><span class="fu">as_epi_df</span><span class="op">(</span><span class="va">x</span>, <span class="va">as_of</span>, additional_metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An <code>epi_df</code>, <code>data.frame</code>, <a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble::tibble</a>, or <a href="https://tsibble.tidyverts.org/reference/tsibble.html" class="external-link">tsibble::tsibble</a>
to be converted</p></dd>


<dt id="arg-geo-type">geo_type<a class="anchor" aria-label="anchor" href="#arg-geo-type"></a></dt>
<dd><p>DEPRECATED Has no effect. Geo value type is inferred from the
location column and set to "custom" if not recognized.</p></dd>


<dt id="arg-time-type">time_type<a class="anchor" aria-label="anchor" href="#arg-time-type"></a></dt>
<dd><p>DEPRECATED Has no effect. Time value type inferred from the time
column and set to "custom" if not recognized. Unpredictable behavior may result
if the time type is not recognized.</p></dd>


<dt id="arg-as-of">as_of<a class="anchor" aria-label="anchor" href="#arg-as-of"></a></dt>
<dd><p>Time value representing the time at which the given data were
available. For example, if <code>as_of</code> is January 31, 2022, then the <code>epi_df</code>
object that is created would represent the most up-to-date version of the
data available as of January 31, 2022. If the <code>as_of</code> argument is missing,
then the current day-time will be used.</p></dd>


<dt id="arg-additional-metadata">additional_metadata<a class="anchor" aria-label="anchor" href="#arg-additional-metadata"></a></dt>
<dd><p>List of additional metadata to attach to the
<code>epi_df</code> object. The metadata will have <code>geo_type</code>, <code>time_type</code>, and
<code>as_of</code> fields; named entries from the passed list will be included as
well. If your tibble has additional keys, be sure to specify them as a
character vector in the <code>other_keys</code> component of <code>additional_metadata</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>used for specifying column names, as in <code><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">dplyr::rename</a></code>. For
example, <code>geo_value = STATEFP, time_value = end_date</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An <code>epi_df</code> object.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>An <code>epi_df</code> is a tibble with (at least) the following columns:</p><ul><li><p><code>geo_value</code>: A character vector representing the geographical unit of
observation. This could be a country code, a state name, a county code,
etc.</p></li>
<li><p><code>time_value</code>: A date or integer vector representing the time of observation.</p></li>
</ul><p>Other columns can be considered as measured variables, which we also refer to
as signal variables. An <code>epi_df</code> object also has metadata with (at least)
the following fields:</p><ul><li><p><code>geo_type</code>: the type for the geo values.</p></li>
<li><p><code>as_of</code>: the time value at which the given data were available.</p></li>
</ul><p>Most users should use <code>as_epi_df</code>. The input tibble <code>x</code> to the constructor
must contain the columns <code>geo_value</code> and <code>time_value</code>. All other columns
will be preserved as is, and treated as measured variables. If <code>as_of</code> is
missing, then the function will try to guess it from an <code>as_of</code>, <code>issue</code>,
or <code>version</code> column of <code>x</code> (if any of these are present), or from as an
<code>as_of</code> field in its metadata (stored in its attributes); if this fails,
then the current day-time will be used. The <code>new_epi_df</code> constructor
assumes its arguments have already been validated, so it should mainly be
used by advanced users.</p>
<p>Metadata for an <code>epi_df</code> object <code>x</code> can be accessed (and altered) via
<code>attributes(x)$metadata</code>. The first field in the above list, <code>geo_type</code>,
can usually be inferred from the <code>geo_value</code> columns. They are not
currently used by any downstream functions in the <code>epiprocess</code> package,
and serve only as useful bits of information to convey about the data set
at hand. More information on their coding is given below.</p>
<p>The last field in the above list, <code>as_of</code>, is one of the most unique aspects
of an <code>epi_df</code> object. In brief, we can think of an <code>epi_df</code> object as a
single snapshot of a data set that contains the most up-to-date values of
the signals variables, as of the time specified in the <code>as_of</code> field.</p>
<p>A companion object is the <code>epi_archive</code> object, which contains the full
version history of a given data set. Revisions are common in many types of
epidemiological data streams, and paying attention to data revisions can be
important for all sorts of downstream data analysis and modeling tasks. See
the documentation for <code><a href="epi_archive.html">epi_archive</a></code> for more details on how
data versioning works in the <code>epiprocess</code> package (including how to
generate <code>epi_df</code> objects, as data snapshots, from an <code>epi_archive</code>
object).</p>
    </div>
    <div class="section level2">
    <h2 id="geo-types">Geo Types<a class="anchor" aria-label="anchor" href="#geo-types"></a></h2>


<p>The following geo types are recognized in an <code>epi_df</code>.</p><ul><li><p><code>"county"</code>: each observation corresponds to a U.S. county; coded by 5-digit
FIPS code.</p></li>
<li><p><code>"hrr"</code>: each observation corresponds to a U.S. hospital referral region
(designed to represent regional healthcare markets); there are 306 HRRs in
the U.S; coded by number (nonconsecutive, between 1 and 457).</p></li>
<li><p><code>"state"</code>: each observation corresponds to a U.S. state; coded by 2-digit
postal abbreviation (lowercase);
note that Puerto Rico is "pr" and Washington D.C. is "dc".</p></li>
<li><p><code>"hhs"</code>: each observation corresponds to a U.S. HHS region; coded by number
(consecutive, between 1 and 10).</p></li>
<li><p><code>"nation"</code>: each observation corresponds to a country; coded by ISO 31661-
alpha-2 country codes (lowercase).</p></li>
</ul><p>An unrecognizable geo type is labeled "custom".</p>
    </div>
    <div class="section level2">
    <h2 id="time-types">Time Types<a class="anchor" aria-label="anchor" href="#time-types"></a></h2>


<p>The following time types are recognized in an <code>epi_df</code>.</p><ul><li><p><code>"day"</code>: each observation corresponds to a day; coded as a <code>Date</code> object,
as in <code>as.Date("2022-01-31")</code>.</p></li>
<li><p><code>"week"</code>: each observation corresponds to a week; the alignment can be
arbitrary (as to whether a week starts on a Monday, Tuesday); coded as a
<code>Date</code> object, representing the start date of week.</p></li>
<li><p><code>"yearmonth"</code>: each observation corresponds to a month; coded as a
<code><a href="https://tsibble.tidyverts.org/reference/year-month.html" class="external-link">tsibble::yearmonth</a></code> object.</p></li>
<li><p><code>"integer"</code>: a generic integer index (e.g. years or something else).</p></li>
</ul><p>An unrecognizable time type is labeled "custom".</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Convert a `tsibble` that has county code as an extra key</span></span></span>
<span class="r-in"><span><span class="co"># Notice that county code should be a character string to preserve any leading zeroes</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ex1_input</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  geo_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ca"</span>, <span class="st">"fl"</span>, <span class="st">"pa"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  county_code <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"06059"</span>, <span class="st">"06061"</span>, <span class="st">"06067"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"12111"</span>, <span class="st">"12113"</span>, <span class="st">"12117"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"42101"</span>, <span class="st">"42103"</span>, <span class="st">"42105"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>,</span></span>
<span class="r-in"><span>  time_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-06-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-06-03"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    by <span class="op">=</span> <span class="st">"day"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">geo_value</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  value <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">geo_value</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.01</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">geo_value</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">tsibble</span><span class="fu">::</span><span class="fu"><a href="https://tsibble.tidyverts.org/reference/as-tsibble.html" class="external-link">as_tsibble</a></span><span class="op">(</span>index <span class="op">=</span> <span class="va">time_value</span>, key <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">geo_value</span>, <span class="va">county_code</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The `other_keys` metadata (`"county_code"` in this case) is automatically</span></span></span>
<span class="r-in"><span><span class="co"># inferred from the `tsibble`'s `key`:</span></span></span>
<span class="r-in"><span><span class="va">ex1</span> <span class="op">&lt;-</span> <span class="fu">as_epi_df</span><span class="op">(</span>x <span class="op">=</span> <span class="va">ex1_input</span>, as_of <span class="op">=</span> <span class="st">"2020-06-03"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">ex1</span>, <span class="st">"metadata"</span><span class="op">)</span><span class="op">[[</span><span class="st">"other_keys"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "county_code"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Dealing with misspecified column names:</span></span></span>
<span class="r-in"><span><span class="co"># Geographical and temporal information must be provided in columns named</span></span></span>
<span class="r-in"><span><span class="co"># `geo_value` and `time_value`; if we start from a data frame with a</span></span></span>
<span class="r-in"><span><span class="co"># different format, it must be converted to use `geo_value` and `time_value`</span></span></span>
<span class="r-in"><span><span class="co"># before calling `as_epi_df`.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ex2_input</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="fu">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html" class="external-link">tibble</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ca"</span>, <span class="st">"fl"</span>, <span class="st">"pa"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="co"># misnamed</span></span></span>
<span class="r-in"><span>  pol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"swing"</span>, <span class="st">"swing"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="co"># extra key</span></span></span>
<span class="r-in"><span>  reported_date <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-06-01"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"2020-06-03"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    by <span class="op">=</span> <span class="st">"day"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span><span class="op">)</span>, <span class="co"># misnamed</span></span></span>
<span class="r-in"><span>  value <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.01</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">state</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ex2_input</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 9 × 4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   state pol   reported_date value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;date&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> ca    blue  2020-06-01    0.991</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> ca    blue  2020-06-02    2.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> ca    blue  2020-06-03    3.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> fl    swing 2020-06-01    3.99 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> fl    swing 2020-06-02    5.01 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> fl    swing 2020-06-03    6.02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">7</span> pa    swing 2020-06-01    7.00 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">8</span> pa    swing 2020-06-02    7.99 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">9</span> pa    swing 2020-06-03    9.00 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ex2</span> <span class="op">&lt;-</span> <span class="va">ex2_input</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>geo_value <span class="op">=</span> <span class="va">state</span>, time_value <span class="op">=</span> <span class="va">reported_date</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">as_epi_df</span><span class="op">(</span></span></span>
<span class="r-in"><span>    as_of <span class="op">=</span> <span class="st">"2020-06-03"</span>,</span></span>
<span class="r-in"><span>    additional_metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>other_keys <span class="op">=</span> <span class="st">"pol"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">ex2</span>, <span class="st">"metadata"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $geo_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "state"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $time_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "day"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $as_of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-06-03"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $other_keys</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "pol"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Adding additional keys to an `epi_df` object</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ex3_input</span> <span class="op">&lt;-</span> <span class="va">jhu_csse_county_level_subset</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">time_value</span> <span class="op">&gt;</span> <span class="st">"2021-12-01"</span>, <span class="va">state_name</span> <span class="op">==</span> <span class="st">"Massachusetts"</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_tail</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ex3</span> <span class="op">&lt;-</span> <span class="va">ex3_input</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="fu">tsibble</span><span class="fu">::</span><span class="fu"><a href="https://tsibble.tidyverts.org/reference/as-tsibble.html" class="external-link">as_tsibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span> <span class="co"># needed to add the additional metadata</span></span></span>
<span class="r-in"><span>  <span class="co"># add 2 extra keys</span></span></span>
<span class="r-in"><span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    state <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"MA"</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    pol <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"swing"</span>, <span class="st">"swing"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>  <span class="co"># the 2 extra keys we added have to be specified in the other_keys</span></span></span>
<span class="r-in"><span>  <span class="co"># component of additional_metadata.</span></span></span>
<span class="r-in"><span>  <span class="fu">as_epi_df</span><span class="op">(</span>additional_metadata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>other_keys <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"state"</span>, <span class="st">"pol"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">ex3</span>, <span class="st">"metadata"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $geo_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "county"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $time_type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "week"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $as_of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2024-08-20 22:41:43 UTC"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $other_keys</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "state" "pol"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Logan Brooks, Daniel McDonald, Evan Ray, Ryan Tibshirani.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

